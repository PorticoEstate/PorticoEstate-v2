var JqueryPortico={};function updateTablePaginator(e,t){var a=e;if(0!=a.limit){a.start+=t;var n=0;a.start<0&&(a.start=0,n++),a.start>a.max&&(a.start-=t,n++),a.start-Math.abs(t)<0?(a.tablePaginatorPrevButton.classList.add("disabled"),a.tablePaginatorPrevButton.classList.remove("enabled")):(a.tablePaginatorPrevButton.classList.remove("disabled"),a.tablePaginatorPrevButton.classList.add("enabled")),a.start+Math.abs(t)>a.max?(a.tablePaginatorNextButton.classList.add("disabled"),a.tablePaginatorNextButton.classList.remove("enabled")):(a.tablePaginatorNextButton.classList.remove("disabled"),a.tablePaginatorNextButton.classList.add("enabled")),n>0||createTable(a.container,a.url,a.col,a.r,a.class,a)}}function createPaginatorTable(e,t){var a=t;a.limit||(a.limit=0);var n=document.createElement("ul"),r=document.getElementById(e),o=document.createElement("li"),i=document.createElement("li"),l=document.createElement("li"),c=document.createElement("a"),s=document.createElement("a");n.style.display="none",n.classList.add("tablePaginator"),o.classList.add("tablePaginatorPrev"),i.classList.add("tablePaginatorText"),l.classList.add("tablePaginatorNext"),c.classList.add("disabled"),s.classList.add("enabled"),c.innerHTML="Prev",s.innerHTML="Next",o.appendChild(c),l.appendChild(s),n.appendChild(o),n.appendChild(i),n.appendChild(l),a.tablePaginator=n,a.tablePaginatorText=i,a.tablePaginatorPrevButton=c,a.tablePaginatorNextButton=s,a.start||(a.start=0),c.addEventListener("click",function(){updateTablePaginator(a,-1*parseInt(a.limit))},!1),s.addEventListener("click",function(){updateTablePaginator(a,parseInt(a.limit))},!1),r.appendChild(n)}function createTableWithFilter(e,t,a,n,r,o,i,l){var c=document.getElementById(e),s=document.createElement("div");s.className="table-filter";var d=document.createElement("select");d.id=e+"_filter",d.className="table-filter-select";var u=document.createElement("option");if(u.value="",u.text=i.placeholder||"All items",d.appendChild(u),i&&i.options&&i.options.forEach(function(e){var t=document.createElement("option");t.value=e.value,t.text=e.text,d.appendChild(t)}),i&&i.label){var p=document.createElement("label");p.htmlFor=d.id,p.textContent=i.label+": ",s.appendChild(p)}return s.appendChild(d),c.firstChild?c.insertBefore(s,c.firstChild):c.appendChild(s),createTable(e,t,a,n,r,o,l),d.addEventListener("change",function(){var c=this.value,s=i.paramName||"filter",d=t;c&&(d=t.indexOf("?")>-1?t+"&"+s+"="+encodeURIComponent(c):t+"?"+s+"="+encodeURIComponent(c)),$("#"+e+" table").remove(),createTable(e,d,a,n,r,o,l)}),d}function createTable(e,t,a,n,r,o,i){var l=document.getElementById(e),c=document.createElement("table"),s=document.createElement("thead"),d=document.createElement("tr");if(l){var u=null,p="No records found";try{u=JqueryPortico.i18n.datatable(),p=u.emptyTable}catch(e){}n=n||"data";var m=r||"table";c.setAttribute("class",m),c.setAttribute("width","100%"),$.each(a,function(e,t){var a=t.label?t.label:"",n=document.createElement("th");n.innerHTML=a,t.attrs&&$.each(t.attrs,function(e,t){n.setAttribute(t.name,t.value)}),d.appendChild(n)}),s.appendChild(d),c.appendChild(s);var h=document.createElement("tbody"),f=document.createElement("tr"),b=document.createElement("td"),v="";b.setAttribute("colspan",a.length),b.innerHTML="Loading...",f.appendChild(b),h.appendChild(f),c.appendChild(h),$("#"+e+" span.select_first_text").remove(),$("#"+e+" table").remove(),o&&(o.container=e,o.url=t,o.col=a,o.r=n,o.class=r,t+="&results="+o.limit+"&length="+o.limit+"&startIndex="+o.start),l.appendChild(c),$.get(t,function(e){var t=new Array,r="";"object"==typeof n?(t=e,$.each(n,function(e,a){t=t[a.n]}),r=e.ResultSet.totalRecords):(t=e[n],r=e.recordsTotal),t&&(h.innerHTML="",0==t.length?(f.innerHTML="",b.setAttribute("colspan",a.length),b.innerHTML=p,f.appendChild(b),h.appendChild(f)):(o&&(o.tablePaginator.style.display="block",o.max=r,o.tablePaginatorText.innerHTML=o.start+1+" - "+(o.start+o.limit>o.max||0==o.limit?o.max:o.start+o.limit)+" / "+o.max,(o.limit>o.max||0==o.limit)&&(o.tablePaginatorNextButton.classList.add("disabled"),o.tablePaginatorNextButton.classList.remove("enabled"))),$.each(t,function(e,t){var n=document.createElement("tr");$.each(a,function(e,a){var r=document.createElement("td");if(v="",a.object){var o=[];$.each(a.object,function(e,n){var r=new Array;if($.each(n.attrs,function(e,t){r.push({name:t.name,value:t.value})}),a.value){var i=0;$.each(r,function(e,t){"value"==t.name&&i++}),0==i&&r.push({name:"value",value:t[a.value]})}a.checked&&(vcc=a.checked,$.each(r,function(e,t){"value"==t.name&&("string"==typeof vcc?vcc==t.value&&r.push({name:"checked",value:"checked"}):-1==jQuery.inArray(t.value,vcc)&&-1==jQuery.inArray(t.value.toString(),vcc)&&-1==jQuery.inArray(parseInt(t.value),vcc)||r.push({name:"checked",value:"checked"}))})),a.disabled&&(vcd=a.disabled,$.each(r,function(e,t){"value"==t.name&&("string"==typeof vcd?vcd==t.value&&(r.push({name:"disabled",value:"disabled"}),r.push({name:"style",value:"display:none;"})):-1==jQuery.inArray(t.value,vcd)&&-1==jQuery.inArray(t.value.toString(),vcd)&&-1==jQuery.inArray(parseInt(t.value),vcd)||(r.push({name:"disabled",value:"disabled"}),r.push({name:"style",value:"display:none;"})))})),o.push({type:n.type,attrs:r})});var i=createObject(o);$.each(i,function(e,t){r.appendChild(t)})}else if(a.formatter){vcfa=[],vcft="genericLink","function"==typeof a.formatter?(vcfa=[],vcft=a.formatter==genericLink2?"genericLink2":"genericLink"):"object"==typeof a.formatter&&(vcfa=a.formatter.arguments,vcft=a.formatter.type);var l=a.key,c="",s="";vcfa.length>0?$.each(vcfa,function(e,a){"string"==typeof a?(s=a,label_name=a):(s=a.label?a.label:t[l],label_name=a.name?a.name:""),"Edit"==label_name||"edit"==label_name?vcfLink="option_edit":"Delete"==label_name||"delete"==label_name?vcfLink="option_delete":"dellink"==label_name?(vcfLink="dellink",s="slett"):vcfLink="",c+=e>0?"&nbsp;":"",c+="genericLink2"==vcft?formatGenericLink2(s,t[vcfLink]):formatGenericLink(s,t[vcfLink])}):(c=t[l],"genericLink2"==vcft?(c=t.dellink?formatGenericLink2("slett",t[l]):c,c=t.option_delete?formatGenericLink2("slett",t[l]):c):c=t.link?formatGenericLink(t[l],t.link):c),v=c,r.innerHTML=v}else{l=a.key;v=t[l],r.innerHTML=v}a.attrs&&$.each(a.attrs,function(e,t){r.setAttribute(t.name,t.value)}),n.appendChild(r)}),h.appendChild(n)})))}).done(function(){try{i()}catch(e){}})}}function createObject(e){var t=new Array;return $.each(e,function(e,a){type=a.type;var n=document.createElement(type);$.each(a.attrs,function(e,t){n.setAttribute(t.name,t.value)}),e>0&&t.push("&nbsp;"),"button"===n.getAttribute("type")&&"undefined"!==n.getAttribute("innerHTML")&&(n.innerHTML=n.getAttribute("innerHTML")),"radio"==n.getAttribute("type")&&(n.getAttribute("onclick")||(n.onclick=function(e){if("true"==$(this).attr("previousValue"))this.checked=!1,$(this).attr("previousValue",this.checked);else{this.checked=!0,$(this).attr("previousValue",this.checked);try{local_custom_radio_action(this)}catch(e){console.log(e)}}})),t.push(n)}),t}function populateSelect(e,t,a,n){a.html("");var r=document.createElement("select"),o=document.createElement("option");n&&$.each(n,function(e,t){r.setAttribute(t.name,t.value)}),a.append(r),o.setAttribute("value",""),o.text="-----",r.appendChild(o),$.get(e,function(e){$.each(e.data,function(e,a){var n=document.createElement("option");n.text=a.name,n.setAttribute("value",a.id),a.id==t&&(n.selected=!0),r.appendChild(n)})})}function populateSelect_activityCalendar(e,t,a){t.html("");var n=document.createElement("select"),r=document.createElement("option");a&&$.each(a,function(e,t){n.setAttribute(t.name,t.value)}),r.setAttribute("value",""),r.text="Velg gateadresse",$.get(e,function(e){var a=e.ResultSet.Result;$.each(a,function(e,t){var a=document.createElement("option");a.text=t.name,void 0!==t.id?a.setAttribute("value",t.id):a.setAttribute("value",t.name),n.appendChild(a)}),a.length>0&&t.append(n)}).fail(function(){alert("AJAX doesn't work")})}function createTableSchedule(d,u,c,r,cl,a,p,t){var container=document.getElementById(d),container_toolbar=document.createElement("div"),xtable=document.createElement("table"),tableHead=document.createElement("thead"),tableHeadTr=document.createElement("tr"),date=a&&a.date?a.date:"";restartColors(),r=r||"data";var tableClass=cl||"pure-table";xtable.setAttribute("class",tableClass),$.each(c,function(e,t){var a=t.label?t.label:"",n=document.createElement("th");n.innerHTML=a,tableHeadTr.appendChild(n)}),tableHead.appendChild(tableHeadTr),xtable.appendChild(tableHead);var key=c[0].key,tableBody=document.createElement("tbody"),tableBodyTr=document.createElement("tr"),tableBodyTrTd=document.createElement("td");tableBodyTrTd.setAttribute("colspan",c.length),tableBodyTrTd.innerHTML="Loading...",tableBodyTr.appendChild(tableBodyTrTd),tableBody.appendChild(tableBodyTr),xtable.appendChild(tableBody),container.innerHTML="",container.appendChild(container_toolbar),container.appendChild(xtable),$.post(u,a,function(data){var selected=new Array;if("object"==typeof r?(selected=data,$.each(r,function(e,t){selected=selected[t.n]})):selected=data[r],selected)if(0==selected.length)tableBody.innerHTML="",tableBodyTr.innerHTML="",tableBodyTrTd.setAttribute("colspan",c.length),tableBodyTrTd.innerHTML="No records found",tableBodyTr.appendChild(tableBodyTrTd),tableBody.appendChild(tableBodyTr);else{if(tableBody.innerHTML="",$.each(selected,function(e,t){var a=document.createElement("tr"),n="0",r="0";$.each(c,function(e,o){var i=o.key,l=o.type&&"th"==o.type?"th":"td",c=document.createElement(l),s="",d="";if(o.formatter){var u=setFormatter(o.formatter,t,o,date);u.text&&(d=u.text),u.classes&&(s+=" "+u.classes),u.trAttributes&&$.each(u.trAttributes,function(e,t){a.setAttribute(t.attribute,t.value)}),u.trFunction&&$.each(u.trFunction,function(e,t){c.addEventListener(t.event,t.callFunction,!1)}),c.setAttribute("class",s)}else d=t[i]?o.value?t[i][o.value]:t[i]:"";i==key&&(n=t[i]?"2":"1"),0==e?(r=n,n=t[i]?n:"0"):n=r,c.setAttribute("style","border-top:"+n+"px solid #cbcbcb;"),c.innerHTML=d,a.appendChild(c)}),tableBody.appendChild(a)}),p){var start=a.start,total=data.ResultSet.totalResultsAvailable,n_objects=a.length;start=start>total?0:start;var pages=Math.floor(total/n_objects),res=total%n_objects,page=0==start?1:start/n_objects+1;pages=res>0?pages+1:pages,pages=0==pages?pages+1:pages;var paginator=createPaginatorSchedule(pages,page);container.appendChild(paginator);var input_start=document.createElement("input");input_start.setAttribute("type","hidden"),input_start.setAttribute("name","start_index"),input_start.setAttribute("id","start_index"),input_start.value=start,container.appendChild(input_start)}if(t){var toolbar=eval(t+"()");container_toolbar.appendChild(toolbar)}}})}function createPaginatorSchedule(e,t){var a=e,n=new Array,r="",o="";for(i=1;i<=a;i++)(r=1==i||t-1<4&&i<=5||i>=t-1&&i<=t+1||a-t<4&&i>=a-4||i==a?i:"...")!=o&&(n.push(r),o=r);var l=document.createElement("div");l.classList.add("schedule_paginate"),l.id="schedule-container_paginate";var c=document.createElement("a"),s=document.createElement("a");c.classList.add("paginate_button","previous"),s.classList.add("paginate_button","next"),c.innerHTML="Prev",s.innerHTML="Next",t>1?c.dataset.page=t-1:c.classList.add("disabled"),t<e?s.dataset.page=t+1:s.classList.add("disabled"),l.appendChild(c);var d="paginate_button";return $.each(n,function(e,a){d="paginate_button";var n=document.createElement("span");"..."==a&&(d="ellipsis"),n.classList.add(d),n.dataset.page=a,a==t&&n.classList.add("current"),n.innerHTML=a,l.appendChild(n)}),l.appendChild(s),l}function setFormatter(callFunc,data,col,date){return eval(callFunc+"(data,col,date)")}function scheduleResourceColumn(e,t,a){var n=[],r=t.key;e[r]&&n.push({attribute:"resource",value:e.resource_id});var o=a?e.resource_link+"#date="+a:e.resource_link;return{text:e[r]?formatGenericLink(e.resource,o):"",classes:"",trAttributes:n,trFunction:[]}}function seasonDateColumn(e,t,a){var n="",r="",o=[],i=t.key;if(e[i]){var l=e[i].id,c=e[i].shortname?formatScheduleShorten(e[i].shortname,9):formatScheduleShorten(e[i].name,9);n=c,r=formatScheduleCellDateColumn(c,e[i].type),o.push({event:"click",callFunction:function(){schedule.newAllocationForm({id:l})}})}else n=lang.free||"free",r="free",o.push({event:"click",callFunction:function(){schedule.newAllocationForm({_from:e._from,_to:e._to,wday:t.key})}});return{text:n,classes:r,trAttributes:[],trFunction:o}}function scheduleDateColumn(e,t,a){var n="",r="",o=t.key;if(e[o]){var i=e[o].shortname?formatScheduleShorten(e[o].shortname,9):formatScheduleShorten(e[o].name,9),l=formatScheduleCellDateColumn(i,e[o].type);n=formatGenericLink(i,null),r=l}return{text:n,classes:r,trAttributes:[],trFunction:[]}}function backendScheduleDateColumn(e,t,a){var n="",r="",o=[],i=t.key;if(e[i]){var l=e[i].id,c=e[i].shortname?formatScheduleShorten(e[i].shortname,9):formatScheduleShorten(e[i].name,9);c=c||formatScheduleShorten(e[i].activity_name,9);var s=e[i].type,d=formatScheduleCellDateColumn(c,s),u=new Array;e[i].conflicts&&e[i].conflicts.length>0&&(u=e[i].conflicts),n=formatBackendScheduleDateColumn(l,c,s,u),r=d+" "+s}else n=lang.free||"free",r="free",o.push({event:"click",callFunction:function(){schedule.newApplicationForm(t.date,e._from,e._to)}});return{text:n,classes:r,trAttributes:[],trFunction:o}}function frontendScheduleDateColumn(e,t,a){var n="",r="",o=[],i=t.key;if(e[i]){var l=e[i].shortname?formatScheduleShorten(e[i].shortname,9):formatScheduleShorten(e[i].name,9);l&&"dummy"!=l||void 0===e[i].contact_name||null===e[i].contact_name||""===e[i].contact_name||(l=formatScheduleShorten(e[i].contact_name,9)),l&&"dummy"!=l||(l=formatScheduleShorten(e[i].activity_name,9));var c=e[i].type;formatScheduleCellDateColumn(l,c);0==e[i].is_public&&(l=formatScheduleShorten("Privat arr.",9)),r="cellInfo "+c,"closed"===l||"Stengt"===l?r+=" calender-closed":"allocation"===c?r+=" calender-allocation":"booking"===c?r+=" calender-booking":"event"===c&&(r+=" calender-event"),n=l,o.push({event:"click",callFunction:function(){var t=$(this).parent().attr("resource");schedule.showInfo(e[i].info_url,t),setTimeout(function(){document.querySelector(".ui-widget-overlay").addEventListener("click",function(){document.querySelector(".ui-dialog-titlebar-close").click()})},200)}})}else n=lang.free||"free",r="calender-free",o.push({event:"click",callFunction:function(){var a=$(this).parent().attr("resource");schedule.newApplicationForm(t.date,e._from,e._to,a)}});return{text:n,classes:r,trAttributes:[],trFunction:o}}function rentalSchedule(data,col,date){var text="",classes="",trAttributes=[],trFunction=[],k=col.key,needFree=!0;data[k]?(text=data[k].status,"Ikke ledig"==text&&(needFree=!1)):(text=lang.free||"free",classes="free"),trAttributes.push({attribute:"data-id",value:data.id}),trFunction.push({event:"click",callFunction:function(){$(this).parent().parent().find("tr").removeClass("trselected"),$(this).parent().addClass("trselected"),$("#schedule_toolbar button").attr("disabled",!1);var b_needFree=eval(needFree);b_needFree||$("#schedule_toolbar button.need-free").attr("disabled",!0),schedule.rental.data=data,schedule.rental.col=col}});var data_return={text:text,classes:classes,trAttributes:trAttributes,trFunction:trFunction};return data_return}function rentalScheduleApplication(data,col,date){var text="",classes="",trAttributes=[],trFunction=[],validate=!1;if(schedule.rental.availability_from&&schedule.rental.availability_to&&col.date>=schedule.rental.availability_from&&col.date<=schedule.rental.availability_to&&(validate=!0),validate){var k=col.key,needFree=!0;data[k]?(text=data[k].status,"Ikke ledig"==text&&(needFree=!1)):(text=lang.free||"free",classes="free"),trAttributes.push({attribute:"data-id",value:data.id}),trFunction.push({event:"click",callFunction:function(){$(this).parent().parent().find("tr").removeClass("trselected"),$(this).parent().addClass("trselected"),$("#schedule_toolbar button").attr("disabled",!1);var b_needFree=eval(needFree);b_needFree||$("#schedule_toolbar button.need-free").attr("disabled",!0),schedule.rental.data=data,schedule.rental.col=col}})}var data_return={text:text,classes:classes,trAttributes:trAttributes,trFunction:trFunction};return data_return}function rentalScheduleComposites(e,t,a){var n,r=[],o=[],i=t.key;return n=e[i],r.push({attribute:"data-id",value:e.id}),o.push({event:"click",callFunction:function(){$(this).parent().parent().find("tr").removeClass("trselected"),$(this).parent().addClass("trselected"),$("#composites_toolbar button").attr("disabled",!1),composites.rental.data=e,composites.rental.col=t}}),{text:n,classes:"",trAttributes:r,trFunction:o}}function restartColors(){colors=["color1","color2","color3","color4","color5","color6","color7","color8","color9","color10","color11","color12","color13","color14","color15","color16","color17","color18","color19","color20","color21","color22","color23","color24","color25","color26","color27","color28","color29","color30","color31","color32","color33","color34","color35","color36","color37","color38","color39","color40","color41","color42","color43","color44","color45","color46","color47","color48","color49","color50","color51","color52","color53","color54","color55","color56","color57","color58","color59","color60"],colorMap={}}function formatScheduleCellDateColumn(e,t){return colorMap[e]||(colorMap[e]=colors.length?colors.shift():"color60"),colorMap[e]}function formatBackendScheduleDateColumn(e,t,a,n){var r="",o="";return n=n||{},"booking"==a?r=phpGWLink("index.php",{menuaction:"booking.uibooking.edit",id:e}):"allocation"==a?r=phpGWLink("index.php",{menuaction:"booking.uiallocation.edit",id:e}):"event"==a&&(r=phpGWLink("index.php",{menuaction:"booking.uievent.edit",id:e})),o=formatGenericLink(t,r),"event"==a&&n.length>0&&$.each(n,function(e,t){var a=formatBackendScheduleDateColumn(t.id,formatScheduleShorten(t.name,9),t.type);o+="<p class='conflicts'>conflicts with: "+a+"</p>"}),o}function formatFrontendScheduleDateColumn(){}function formatScheduleShorten(e,t){return t&&e.length>t&&(e=e.substr(e,t)+"..."),e}function getUrlData(e){if("string"==typeof e){var t=self.location.href.indexOf("#");if(t>0)for(var a=self.location.href.substr(t+1).split("&"),n=a.length,r=0;r<n;r++){var o=a[r].split("=");if(2==o.length)if(o[0]==e)return _decodeStringUrl(o[1])}}}function _decodeStringUrl(e){return decodeURIComponent(e.replace(/\+/g," "))}function genericLink(){var e=[];return e.arguments=arguments,e.type="genericLink",e}function genericLink2(){var e=[];return e.arguments=arguments,e.type="genericLink2",e}function formatGenericLink(e,t){return!1===t?"":e&&t?"<a href='"+t+"'>"+e+"</a>":e}function formatGenericLink2(e,t){return!1===t?"":e&&t?"<a onclick='return confirm(\"Er du sikker pÃ¥ at du vil slette denne?\")' href='"+t+"'>"+e+"</a>":e}JqueryPortico.parseURL=function(e){var t,a,n,r=document.createElement("a"),o={};for(r.href=e,t=r.search.replace(/^\?/,"").split("&"),n=0;n<t.length;n++)o[(a=t[n].split("="))[0]]=a[1];return{protocol:r.protocol,host:r.host,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search,searchObject:o,hash:r.hash}},JqueryPortico.formatLink=function(e,t){var a=t[e];return'<a href="'+t.link+'">'+a+"</a>"},JqueryPortico.formatLinkEvent=function(e,t){return'<a href="'+t.url+'">Link</a>'},JqueryPortico.formatLinkTenant=function(e,t){var a=t[e];return'<a href="'+phpGWLink("index.php",{menuaction:"property.uiworkorder.edit",id:a})+'">'+a+"</a>"},JqueryPortico.formatLinkTicket=function(e,t){var a=t[e];return'<a href="'+phpGWLink("index.php",{menuaction:"property.uitts.view",id:a})+'">'+a+"</a>"},JqueryPortico.formatProject=function(e,t){var a=t[e];return'<a href="'+t.link+"&id="+a+'">'+a+"</a>"},JqueryPortico.formatLinkGallery=function(e,t){return'<a href="'+t[e]+'" target="_blank">Link</a>'},JqueryPortico.formatLinkGeneric=function(e,t){if(!t[e])return"";var a=t[e];if("option_edit"==e)var n=a,r="Edit";else if("option_delete"==e)n=a,r="Delete";else if("actions"==e)n=a,r="Delete";else if("object"==typeof a)n=a.href,r=a.label;else r="Link",n=a;return n?'<a href="'+n+'">'+r+"</a>":r},JqueryPortico.formatLinkGenericLlistAttribute=function(e,t){var a=t.link,n=t.link.split("."),r="";if(r="up"==e?"up":"down","uiadmin_entity"==n[2]||"ui_custom"==n[2])var o="'"+a+"&resort="+r+"'";else o="'"+a+"&resort="+r+"',''";return'<a href="#" onclick="JqueryPortico.move_record('+o+')">'+e+"</a>"},JqueryPortico.move_record=function(e){var t=e+"&confirm=yes&phpgw_return_as=json";$.post(t,function(e){oTable.api().draw()})},JqueryPortico.searchLink=function(e,t){if(void 0!==t[e]){var a=t[e];return'<a href="#" id="'+t.query_location[e]+'" onclick="searchData(this.id);">'+a+"</a>"}},JqueryPortico.formatCheck=function(e,t){var a="",n="";return t.responsible_item&&(a="checked = 'checked'",n='<input type="hidden" class="orig_check"  name="values[assign_orig][]" value="'+t.responsible_contact_id+"_"+t.responsible_item+"_"+t.location_code+'"/>'),n+'<center><input type="checkbox" '+a+' class="mychecks"  name="values[assign][]" value="'+t.location_code+'"/></center>'},JqueryPortico.formatCheckUis_agremment=function(e,t){return'<center><input type="checkbox"  class="mychecks"  name="values[alarm]['+t.id+']" value="" /></center>'},JqueryPortico.formatCheckCustom=function(e,t){return'<center><input type="checkbox"  class="mychecks"  name="values[delete][]" value="'+t.id+'" /></center>'},JqueryPortico.formatUpDown=function(e,t){return'<a href="'+t.link_up+'">up</a> | <a href="'+t.link_down+'">down</a>'},JqueryPortico.formatRadio=function(e,t){return'<center><input type="radio" name="rad_template" class="myValuesForPHP" value="'+t.template_id+'" /></center>'},JqueryPortico.showPicture=function(e,t){var a="";if(t.img_id){var n=t.file_name,r=(t.img_id,t.img_url);a="<img onclick=\"JqueryPortico.show_picture_popup('"+r+"');\" src='"+r+"&"+t.thumbnail_flag+"' alt='"+n+"' />"}return a},JqueryPortico.show_picture_popup=function(e){var t="<h4 style='text-align: center;'><a href='"+e+"'>Download</a></h4>";t+="<img src='"+e+"' style ='display: block; margin-left: auto; margin-right: auto; width: "+Math.round(.9*$(window).width())+"px;'/>",TINY.box.show({html:t,boxid:"frameless",width:Math.round(.9*$(window).width()),height:Math.round(.9*$(window).height()),fixed:!1,maskid:"darkmask",maskopacity:40,mask:!0,animate:!0,close:!0})},JqueryPortico.formatJsonArray=function(e,t){const a=[];if(t[e]){var n=t[e];$.each(n,function(e,t){a.push(t)})}return a.join("<br/>")},JqueryPortico.formatJsonArrayData=function(e,t){var a="";const n=[];if(t[e]){var r=t[e];$.each(r,function(e,t){n.push(t)})}var o;return o='<div data="'+(a=n.join("::"))+'" class="'+e+'">',o+='<button style="text-align:left;" class="btn field_'+e+'">',o+="<span>",o+=a.replaceAll("::","<br/>"),o+="</span>",o+="</button>",o+="</div>"},JqueryPortico.FormatterAmount0=function(e,t){return'<div style="text-align:right;">'+$.number(t[e],0,",",".")+"</div>"},JqueryPortico.FormatterAmount2=function(e,t){return'<div style="text-align:right;">'+$.number(t[e],2,",",".")+"</div>"},JqueryPortico.FormatterRight=function(e,t){return'<div style="text-align:right;">'+t[e]+"</div>"},JqueryPortico.FormatterCenter=function(e,t){return"<center>"+t[e]+"</center>"},JqueryPortico.inlineTableHelper=function(container,ajax_url,columns,options,data,num){options=options||{};var disablePagination=options.disablePagination||!1,disableFilter=options.disableFilter||!1,buttons_def=options.TableTools||!1,select=!1,singleSelect=options.singleSelect||!1,order=options.order||[0,"desc"],responsive=options.responsive||!1,initial_search=options.initial_search||!1,editor_action=options.editor_action||!1,editor_cols=[],allrows=options.allrows||!1,pageLength=options.rows_per_page||10,scrollY=options.scrollY||!1,scrollX=!0,fixedColumns=options.fixedColumns||!1;for(scrollY&&(disablePagination=!1),data=data||{},num=num||0,i=0;i<columns.length;i++)!0===columns[i].editor?editor_cols.push({sUpdateURL:editor_action+"&field_name="+columns[i].data}):editor_cols.push(null);var lengthMenu=null;if(10!=pageLength){lengthMenu=[[],[]];for(var i=1;i<5;i++)lengthMenu[0].push(pageLength*i),lengthMenu[1].push(pageLength*i)}else try{lengthMenu=JqueryPortico.i18n.lengthmenu()}catch(e){lengthMenu=[[10,25,50,100],[10,25,50,100]]}var responsive_def=!1;if(1==responsive&&(responsive_def={details:{display:$.fn.dataTable.Responsive.display.childRowImmediate,type:""}}),1==allrows&&0==data.length){lengthmenu_allrows=[];try{lengthmenu_allrows=JqueryPortico.i18n.lengthmenu_allrows()}catch(e){lengthmenu_allrows=[-1,"All"]}2==lengthMenu.length&&(lengthMenu[0].push(lengthmenu_allrows[0]),lengthMenu[1].push(lengthmenu_allrows[1]))}var language=null;try{language=JqueryPortico.i18n.datatable()}catch(e){}if(ajax_url)var ajax_def={url:ajax_url,type:"POST",data:function(d){$("#toolbar select, #toolbar input").each(function(){var e=$(this),t=e.attr("name")||e.attr("id");t&&(d[t]=e.val())});try{isNaN(Number(container.substr(container.length-1,1)))||0!==Object.keys(eval("paramsTable"+container.substr(container.length-1,1))).length&&$.each(eval("paramsTable"+container.substr(container.length-1,1)),function(e,t){d[e]=t})}catch(e){}if(void 0!==d.order){var column=d.order[0].column,dir=d.order[0].dir,column_to_keep=d.columns[column];delete d.columns,d.columns={},d.columns[column]=column_to_keep}return d}},serverSide_def=!0;else var ajax_def=!1,serverSide_def=!1;if(1==singleSelect&&(select=!0),buttons_def){var layout={topStart:"buttons",topEnd:"search",bottomStart:["pageLength"],bottomEnd:["paging"],bottom2Start:"info"};select=1==singleSelect||{style:"multi"}}else var layout={topStart:"pageLength",topEnd:"search",bottomStart:"info",bottomEnd:"paging"};var oTable=$("#"+container).dataTable({columns:columns,scrollY:scrollY,scrollX:scrollX,scroller:!!scrollY,scrollCollapse:!!scrollY,fixedColumns:fixedColumns,paginate:!disablePagination,filter:!disableFilter,info:!disablePagination,order:order,processing:!0,serverSide:serverSide_def,responsive:responsive_def,deferRender:!0,select:select,data:data,ajax:ajax_def,layout:layout,buttons:buttons_def,search:initial_search,lengthMenu:lengthMenu,pageLength:parseInt(pageLength),language:language,fnInitComplete:function(e,t){},fnDrawCallback:function(){void 0!==oTable&&(oTable.api().buttons(".record").enable(!1),oTable.makeEditable({sUpdateURL:editor_action,fnOnEditing:function(e){var t=e.closest("tr").prevAll().length,a=oTable.api().rows(t).data()[0];return id=a.id,cell=e.parents("td"),!0},fnOnEdited:function(e,t,a,n,r,o){try{window["local_OnEditedCallback_"+container.replace("-","_")](oTable)}catch(e){}},oUpdateParameters:{id:function(){return id}},aoColumns:editor_cols,sSuccessResponse:"IGNORE",fnShowError:function(){}}));"function"==typeof addFooterDatatable&&addFooterDatatable(oTable);try{window["local_DrawCallback"+num](container)}catch(e){}}});return $("#"+container+" tbody").on("click","tr",function(){$(this).toggleClass("selected");var e=oTable.api(),t=e.rows(".selected").data().length;e.buttons(".record").enable(t>0);var a=$(this).find('input[type="checkbox"], input[type="radio"]');a&&a.hasClass("mychecks")&&($(this).hasClass("selected")?a.prop("checked",!0):a.prop("checked",!1))}),oTable},JqueryPortico.updateinlineTableHelper=function(e,t){if("string"==typeof e)var a=$("#"+e).dataTable();else a=e;void 0===t?a.api().draw():a.api().ajax.url(t).load();return a},JqueryPortico.fnGetSelected=function(e){for(var t=new Array,a=e.api().rows().nodes(),n=0;n<a.length;n++)$(a[n]).hasClass("selected")&&t.push(n);return t},JqueryPortico.show_message=function(e,t){document.getElementById("message"+e).innerHTML="",void 0!==t.message&&$.each(t.message,function(t,a){$("#message"+e).append(a.msg+"<br>")}),void 0!==t.error&&$.each(t.error,function(t,a){$("#message"+e).append(a.msg+"<br>")})},JqueryPortico.execute_ajax=function(e,t,a,n,r){n=void 0!==n?n:"POST",r=void 0!==r?r:"html",a=void 0!==a?a:{},$.ajax({type:n,dataType:r,data:a,url:e,success:function(e){void 0===e.sessionExpired?t(e):alert("sessionExpired - please log in")}})},JqueryPortico.substr_count=function(e,t,a,n){var r=0;for(e+="",t+="",isNaN(a)&&(a=0),isNaN(n)&&(n=0),a--;-1!=(a=e.indexOf(t,a+1));){if(n>0&&a+t.length>n)return!1;r++}return r},JqueryPortico.autocompleteHelper=function(e,t,a,n,r,o,i,l){o=!!o,i=i||!1,r=r||"name",$(document).ready(function(){if(i)try{e=window[i](e)}catch(e){}$("#"+t).autocomplete({source:function(t,a){$.ajax({url:e,dataType:"json",data:{query:t.term,phpgw_return_as:"json"},success:function(e){var t="";e.ResultSet?t=e.ResultSet.Result:e.data&&(t=e.data),a($.map(t,function(e){return label=o?e.id+" "+e[r]:e[r],{label:label,value:e.id}}))}})},focus:function(e,t){return $(e.target).val(t.item.label),!1},minLength:1,select:function(e,n){$("#"+a).val(n.item.value),setTimeout(function(){$("#"+t).val(n.item.label);try{l(n.item)}catch(e){}},1)}})})},JqueryPortico.openPopup=function(e,t){var a=(t=t||{}).width||Math.round(.9*$(window).width()),n=t.height||Math.round(.9*$(window).height()),r=t.closeAction||!1,o=phpGWLink("index.php",e);TINY.box.show({iframe:o,boxid:"frameless",width:a,height:n,fixed:!1,maskid:"darkmask",maskopacity:40,mask:!0,animate:!0,close:!0,closejs:function(){JqueryPortico.onPopupClose(r)}})},JqueryPortico.onPopupClose=function(e){"reload"==e&&location.reload(),"close"==e&&(TINY.box.hide(),"function"==typeof afterPopupClose&&afterPopupClose())},JqueryPortico.lightboxlogin=function(){var e=phpGWLink("login.php",{lightbox:1}),t=.8*$(window).width();TINY.box.show({iframe:e,boxid:"frameless",width:t,height:400,fixed:!1,maskid:"darkmask",maskopacity:40,mask:!0,animate:!1,close:!1,closejs:!1})},JqueryPortico.showlightbox_history=function(e){TINY.box.show({iframe:e,boxid:"frameless",width:Math.round(.9*$(window).width()),height:Math.round(.9*$(window).height()),fixed:!1,maskid:"darkmask",maskopacity:40,mask:!0,animate:!0,close:!0})},JqueryPortico.checkAll=function(e){$("."+e).each(function(){$(this).prop("checked")?$(this).prop("checked",!1):$(this).prop("checked",!0)})},JqueryPortico.CreateRowChecked=function(e){return myA=document.createElement("A"),url='javascript:JqueryPortico.checkAll("'+e+'")',myA.setAttribute("href",url),url="property/templates/portico/images/check.png",myImg=document.createElement("IMG"),myImg.setAttribute("src",url),myImg.setAttribute("width","16"),myImg.setAttribute("height","16"),myImg.setAttribute("border","0"),myImg.setAttribute("alt","Select All"),myA.appendChild(myImg),mydiv=document.createElement("div"),mydiv.setAttribute("align","center"),mydiv.appendChild(myA),mydiv},parseISO8601=function(e){var t=e.match(new RegExp("(([0-9]{4})(-([0-9]{1,2})(-([0-9]{1,2}))))?( )?(([0-9]{1,2}):([0-9]{1,2}))?")),a=t[2]?1*t[2]:0;return date=new Date(a,(t[4]||1)-1,t[6]||0),t[9]&&date.setHours(t[9]),t[10]&&date.setMinutes(t[10]),date};