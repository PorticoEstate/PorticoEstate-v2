import { QUICK_EVENT, on, onHotReload } from "./utils.js";

//#region src/clickdelegatefor.ts
const CLASS_HOVER = ":click-delegate-hover";
const ATTR_CLICKDELEGATEFOR = "data-clickdelegatefor";
const SELECTOR_CLICKDELEGATEFOR = `[${ATTR_CLICKDELEGATEFOR}]`;
const SELECTOR_SKIP = "a,button,label,input,select,textarea,dialog,[role=\"button\"],[popover],[contenteditable]";
const handleClickDelegateFor = (event) => {
	const isNewTab = event.button === 1 || event.metaKey || event.ctrlKey;
	const delegateTarget = event.isTrusted && event.button < 2 && getDelegateTarget(event);
	if (delegateTarget instanceof HTMLAnchorElement && isNewTab) window.open(delegateTarget.href, void 0, delegateTarget.rel);
	else if (delegateTarget instanceof HTMLElement && !delegateTarget.contains(event.target)) {
		event.stopImmediatePropagation();
		delegateTarget.click();
	}
};
let HOVER;
const handleMouseOver = (event) => {
	const delegateTarget = getDelegateTarget(event);
	if (HOVER === delegateTarget) return;
	if (HOVER) HOVER.classList.remove(CLASS_HOVER);
	if (delegateTarget) delegateTarget.classList.add(CLASS_HOVER);
	HOVER = delegateTarget;
};
const getDelegateTarget = ({ target: el }) => {
	const id = (el instanceof Element ? el.closest(SELECTOR_CLICKDELEGATEFOR) : null)?.getAttribute(ATTR_CLICKDELEGATEFOR);
	const target = document.getElementById(id || "");
	const skip = target && el.closest(SELECTOR_SKIP);
	return (!skip || skip === target) && target || void 0;
};
onHotReload("clickdelegatefor", () => [on(window, "click auxclick", handleClickDelegateFor, true), on(document, "mouseover", handleMouseOver, QUICK_EVENT)]);

//#endregion
export { handleClickDelegateFor };
//# sourceMappingURL=clickdelegatefor.js.map