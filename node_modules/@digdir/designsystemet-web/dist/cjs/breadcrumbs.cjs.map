{"version":3,"file":"breadcrumbs.cjs","names":["DSElement","attr","debounce","on","onMutation","customElements"],"sources":["../../src/breadcrumbs.ts"],"sourcesContent":["import {\r\n  attr,\r\n  attrRequiredWarning,\r\n  customElements,\r\n  DSElement,\r\n  debounce,\r\n  on,\r\n  onMutation,\r\n} from './utils';\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    'ds-breadcrumbs': DSBreadcrumbsElement;\r\n  }\r\n}\r\n\r\nconst ATTR_LABEL = 'aria-label';\r\nconst ATTR_LABEL_HIDDEN = 'data-label'; // Used to hide label on mobile when only showing back link\r\n\r\nexport class DSBreadcrumbsElement extends DSElement {\r\n  _items?: HTMLCollectionOf<HTMLAnchorElement>; // Using underscore instead of private fields for backwards compatibility\r\n  _unresize?: () => void;\r\n  _unmutate?: () => void;\r\n\r\n  static get observedAttributes() {\r\n    return [ATTR_LABEL]; // Using ES2015 syntax for backwards compatibility\r\n  }\r\n  connectedCallback() {\r\n    if (!attr(this, ATTR_LABEL_HIDDEN)) attrRequiredWarning(this, ATTR_LABEL); // aria-label can allready have been hidden by attributeChangedCallback\r\n    const render = debounce(this.attributeChangedCallback.bind(this), 100);\r\n    this._items = this.getElementsByTagName('a'); // Speed up by caching HTMLCollection\r\n    this._unresize = on(window, 'resize', render);\r\n    this._unmutate = onMutation(this, render, {\r\n      debounce: 0, // No debounce, as we already debounce render\r\n      childList: true,\r\n      subtree: true,\r\n    });\r\n  }\r\n  attributeChangedCallback() {\r\n    const last = this._items?.[this._items.length - 1];\r\n    const lastInList = last?.parentElement === this ? null : last;\r\n    const isListHidden = !lastInList?.offsetHeight;\r\n    const labelHidden = attr(this, ATTR_LABEL_HIDDEN);\r\n    const label = attr(this, ATTR_LABEL);\r\n\r\n    // Only labels if needed to prevent infinite attribute update loop\r\n    attr(this, 'role', isListHidden ? null : 'navigation');\r\n    if (isListHidden && !labelHidden && label) {\r\n      attr(this, ATTR_LABEL_HIDDEN, label);\r\n      attr(this, ATTR_LABEL, null);\r\n    } else if (!isListHidden && labelHidden && !label) {\r\n      attr(this, ATTR_LABEL, labelHidden);\r\n      attr(this, ATTR_LABEL_HIDDEN, null);\r\n    }\r\n\r\n    for (const item of this._items || [])\r\n      attr(item, 'aria-current', item === lastInList ? 'page' : null);\r\n  }\r\n  disconnectedCallback() {\r\n    this._unresize?.();\r\n    this._unmutate?.();\r\n    this._unresize = this._unmutate = this._items = undefined;\r\n  }\r\n}\r\n\r\ncustomElements.define('ds-breadcrumbs', DSBreadcrumbsElement);\r\n"],"mappings":";;;AAgBA,MAAM,aAAa;AACnB,MAAM,oBAAoB;AAE1B,IAAa,uBAAb,cAA0CA,wBAAU;CAClD;CACA;CACA;CAEA,WAAW,qBAAqB;AAC9B,SAAO,CAAC,WAAW;;CAErB,oBAAoB;AAClB,MAAI,CAACC,mBAAK,MAAM,kBAAkB,CAAE,mCAAoB,MAAM,WAAW;EACzE,MAAM,SAASC,uBAAS,KAAK,yBAAyB,KAAK,KAAK,EAAE,IAAI;AACtE,OAAK,SAAS,KAAK,qBAAqB,IAAI;AAC5C,OAAK,YAAYC,iBAAG,QAAQ,UAAU,OAAO;AAC7C,OAAK,YAAYC,yBAAW,MAAM,QAAQ;GACxC,UAAU;GACV,WAAW;GACX,SAAS;GACV,CAAC;;CAEJ,2BAA2B;EACzB,MAAM,OAAO,KAAK,SAAS,KAAK,OAAO,SAAS;EAChD,MAAM,aAAa,MAAM,kBAAkB,OAAO,OAAO;EACzD,MAAM,eAAe,CAAC,YAAY;EAClC,MAAM,cAAcH,mBAAK,MAAM,kBAAkB;EACjD,MAAM,QAAQA,mBAAK,MAAM,WAAW;AAGpC,qBAAK,MAAM,QAAQ,eAAe,OAAO,aAAa;AACtD,MAAI,gBAAgB,CAAC,eAAe,OAAO;AACzC,sBAAK,MAAM,mBAAmB,MAAM;AACpC,sBAAK,MAAM,YAAY,KAAK;aACnB,CAAC,gBAAgB,eAAe,CAAC,OAAO;AACjD,sBAAK,MAAM,YAAY,YAAY;AACnC,sBAAK,MAAM,mBAAmB,KAAK;;AAGrC,OAAK,MAAM,QAAQ,KAAK,UAAU,EAAE,CAClC,oBAAK,MAAM,gBAAgB,SAAS,aAAa,SAAS,KAAK;;CAEnE,uBAAuB;AACrB,OAAK,aAAa;AAClB,OAAK,aAAa;AAClB,OAAK,YAAY,KAAK,YAAY,KAAK,SAAS;;;AAIpDI,6BAAe,OAAO,kBAAkB,qBAAqB"}