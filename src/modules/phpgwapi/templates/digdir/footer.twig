{# twig #}
</div></div></div></main>
<footer class="py-4 bg-light mt-auto">
	<div class="container-fluid px-4">
		<div class="text-gray text-center">{{ powered_by|raw }}</div>
	</div>
</footer>
</div></div>
<div id="popupBox"></div>
<div id="curtain"></div>

<!-- Logout Confirmation Dialog -->
<dialog id="logoutModal" class="app-modal">
	<div class="app-modal__content">
		<div class="app-modal__header">
			<h2>{{ logout_text }}</h2>
			<button class="app-modal__close" onclick="document.getElementById('logoutModal').close();" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		<div class="app-modal__body">
			<p class="app-fw-medium">{{ lang_logout_header }}</p>
		</div>
		<div class="app-modal__footer">
			<button class="app-button app-button--secondary" onclick="document.getElementById('logoutModal').close();">{{ lang('Cancel') }}</button>
			<a class="app-button app-button--primary" href="{{ logout_url }}">{{ logout_text }}</a>
		</div>
	</div>
</dialog>

<!-- Support/Popup Modal -->
<div class="app-modal fade" id="popupModal" aria-hidden="true">
	<div class="app-modal-dialog app-modal-lg app-modal-dialog-centered">
		<div class="app-modal-content">
			<div class="app-modal-header app-border-0">
				<button class="app-btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="app-modal-body">
				<iframe id="iframepopupModal" src="about:blank" width="100%" height="380" frameborder="0"
					sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation"
					allowtransparency="true"></iframe>
			</div>
		</div>
	</div>
</div>

{{ javascript_end|raw }}
<script>
$('[data-bs-target="#popupModal"]').on('click', function (e) {
	e.preventDefault();

	var _linky = $(this).attr('href');

	const urlParams = new URLSearchParams(_linky);

	if (urlParams.has('height')) {
		const height = urlParams.get('height');
		$("#iframepopupModal").attr('height', height);
	}

	$("#iframepopupModal").attr("src", _linky);

	if (window.DigdirUI && typeof window.DigdirUI.openModal === 'function') {
		window.DigdirUI.openModal('#popupModal');
	} else {
		$('#popupModal').addClass('show').css('display', 'flex');
	}

	$('#popupModal').on('hidden.bs.modal', function (e) {
		$("#iframepopupModal").attr("src", 'about:blank');
	});
});

/**
 * Disable doubleklick on links
 */
$("a").click(function (event) {
	var link = $(this);
	if ($(this).hasClass("disabledouble")) {
		event.preventDefault();
	}

	$(this).addClass("disabledouble");
	window.setTimeout(function () {
		$(link).removeClass("disabledouble");
	}, 1000);
});

$('#sidebarToggle').on('click', function () {
	document.body.classList.toggle('sb-sidenav-toggled');

	var oArgs = {
		menuaction: 'phpgwapi.template_portico.store',
		location: 'menu_state'
	};
	var requestUrl = phpGWLink('index.php', oArgs, true);

	var state_data = {
		menu_state: document.body.classList.contains('sb-sidenav-toggled')
	};

	$.ajax({
		type: 'POST',
		url: requestUrl,
		data: {
			data: JSON.stringify(state_data)
		},
		dataType: "json",
		success: function (data) {
			if (data) {
				console.log(data);
			}
		}
	});
});
</script>
</body></html>
